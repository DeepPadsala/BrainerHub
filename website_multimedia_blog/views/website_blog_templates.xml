<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="multimedia_filter_bar" inherit_id="website_blog.blog_post_short" name="Multimedia Filter Bar">
        <xpath expr="//div[@id='o_wblog_posts_loop_container']" position="before">
            <div class="container mb-4 mt-2">
                <div class="btn-group d-flex flex-wrap shadow-sm" role="group">
                    <a href="/blog" class="btn btn-outline-primary flex-fill">All</a>
                    <a href="/blog/type/article" class="btn btn-outline-primary flex-fill">Articles</a>
                    <a href="/blog/type/music" class="btn btn-outline-primary flex-fill">Music</a>
                    <a href="/blog/type/video" class="btn btn-outline-primary flex-fill">Video</a>
                    <a href="/blog/type/magazine" class="btn btn-outline-primary flex-fill">Magazine</a>
                    <a href="/blog/type/collection" class="btn btn-outline-primary flex-fill">Collections</a>
                </div>
            </div>
        </xpath>
    </template>

    <template id="multimedia_post_content" inherit_id="website_blog.blog_post_content" name="Multimedia Post Content">
        <xpath expr="//div[@t-field='blog_post.content']" position="before">

            <div t-if="blog_post.content_type == 'video'" class="mb-4">
                <div class="ratio ratio-16x9 shadow rounded overflow-hidden bg-dark">
                    <iframe t-att-src="blog_post.video_url" allowfullscreen="True" frameborder="0"></iframe>
                </div>
            </div>

            <div t-if="blog_post.content_type == 'music'" class="mb-4">
                <div class="card bg-light border-primary shadow-sm">
                    <div class="card-body">
                        <h4 class="card-title text-primary">
                            <i class="fa fa-headphones me-2"/>
                            <t t-esc="blog_post.music_artist"/>
                        </h4>
                        <div class="mt-3">
                            <t t-out="blog_post.music_url"/>
                            <iframe data-testid="embed-iframe" style="border-radius:12px"
                                    t-att-src="blog_post.music_url" width="100%" height="352" frameBorder="0"
                                    allowfullscreen=""
                                    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                                    loading="lazy"></iframe>
                        </div>
                    </div>
                </div>
            </div>

            <div t-if="blog_post.content_type == 'magazine'" class="mb-4 text-center">
                <div class="alert alert-info shadow-sm py-4">
                    <i class="fa fa-book fa-3x mb-3 text-primary"/>
                    <h3>Digital Edition</h3>
                    <a t-att-href="blog_post.magazine_url" class="btn btn-lg btn-primary mt-2" target="_blank">
                        View Full Magazine
                        <i class="fa fa-external-link ms-2"/>
                    </a>
                </div>
            </div>

            <div t-if="blog_post.content_type == 'collection'" class="mt-4 mb-5">
                <h3 class="mb-4 border-bottom pb-2">Curated Collection</h3>
                <div class="row">
                    <t t-foreach="blog_post.collection_ids" t-as="item">
                        <div class="col-md-4 col-sm-6 mb-4">
                            <div class="card h-100 shadow-sm border-0 overflow-hidden">
                                <a t-attf-href="/blog/#{item.blog_id.id}/#{slug(item)}"
                                   class="text-decoration-none text-reset">
                                    <div t-if="item.cover_properties"
                                         t-attf-class="card-img-top #{json.loads(item.cover_properties).get('background_color_class')}"
                                         t-attf-style="height: 140px; background-image: #{json.loads(item.cover_properties).get('background-image')}; background-size: cover; background-position: center;">
                                    </div>
                                    <div t-else="" class="card-img-top bg-200" style="height: 140px;"/>
                                    <div class="card-body p-3">
                                        <span class="badge bg-primary mb-2" t-field="item.content_type"/>
                                        <h6 class="card-title mb-0 fw-bold" t-field="item.name"/>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </t>
                </div>
            </div>
        </xpath>
    </template>
</odoo>